services:
  - type: web
    name: discourse
    env: docker
    region: ohio
    plan: standard
    healthCheckPath: /srv/status
    dockerfilePath: discourse.Dockerfile
    buildFilter:
      ignoredPaths:
        - README.md
        - .gitignore
        - minio*
    envVars:
      - key: DISCOURSE_HOSTNAME
        sync: false
      - key: DISCOURSE_DB_HOST
        fromDatabase:
          name: discourse
          property: host
      - key: DISCOURSE_DB_PORT
        fromDatabase:
          name: discourse
          property: port
      - key: DISCOURSE_DB_NAME
        fromDatabase:
          name: discourse
          property: database
      - key: DISCOURSE_DB_USERNAME
        fromDatabase:
          name: discourse
          property: user
      - key: DISCOURSE_DB_PASSWORD
        fromDatabase:
          name: discourse
          property: password
      - key: DISCOURSE_REDIS_HOST
        sync: false
      - key: DISCOURSE_REDIS_PORT
        sync: false
      - key: DISCOURSE_REDIS_PASSWORD
        sync: false
      - key: DISCOURSE_DEVELOPER_EMAILS
        sync: false
      - key: DISCOURSE_SMTP_DOMAIN
        sync: false
      - key: DISCOURSE_SMTP_PASSWORD
        sync: false
      - key: DISCOURSE_S3_ACCESS_KEY_ID
        sync: false
      - key: DISCOURSE_S3_BUCKET
        sync: false
      - key: DISCOURSE_S3_BACKUP_BUCKET
        sync: false
      - key: DISCOURSE_S3_SECRET_ACCESS_KEY
        sync: false
      - key: DISCOURSE_NOTIFICATION_EMAIL
        sync: false
      - key: DISCOURSE_FORCE_HTTPS
        value: "true"
      - key: EMAIL_ADDRESS
        sync: false
      - key: DISCOURSE_BACKUP_LOCATION
        value: s3
      - key: DISCOURSE_S3_CONFIGURE_TOMBSTONE_POLICY
        value: false
      - key: DISCOURSE_S3_CDN_URL
        sync: false
databases:
  - name: discourse
    region: ohio
    ipAllowList: []
